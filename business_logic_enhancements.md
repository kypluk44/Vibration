# Улучшения бизнес-логики: повышение ежедневной вовлечённости и демонстрации страховых предложений

## 1. Цепочка ежедневных сценариев с прогрессией

**Концепция:** Трансформировать одиночный ежедневный сценарий в связанную мини-историю с 3-4 последовательными точками принятия решений, которые разворачиваются в течение дня.

**Реализация:**
- Утренний сценарий представляет ситуацию ("Завтра ваша поездка")
- Дневное продолжение представляет осложнение ("Прогноз погоды показывает штормы")
- Вечернее заключение предлагает варианты разрешения ситуации

**Интеграция страховых предложений:**
- Каждый сегмент естественным образом вводит страховой элемент (страхование путешествий, защита от погодных условий и т.д.)
- Пользователь не может полностью разрешить ситуацию, пока не пройдет все части, что создает нарративный крючок
- Завершенные ежедневные цепочки выстраиваются в недельные сюжетные арки

**Преимущества для вовлеченности:** Создает несколько естественных точек возврата в течение дня, с каждой сессией продолжительностью 2-3 минуты (всего: 6-9 минут ежедневно)

## 2. Система коллекционируемой энергии с ежедневным восстановлением

**Концепция:** Внедрить систему "Энергетических Очков", которая полностью восстанавливается раз в день и требуется для значимого прогресса.

**Реализация:**
- 5 очков энергии в день, восстанавливающихся в фиксированное время
- Каждое очко позволяет принять одно значимое решение/действие
- Создание "бонуса за серию", где поддержание ежедневной активности предоставляет дополнительную энергию (например, +1 очко за каждый последовательный день, максимум +5)

**Интеграция страховых предложений:**
- Каждая трата энергии выводит страховую подсказку или рекомендацию
- "Премиальные предложения" потребляют 2 очка энергии, но обеспечивают лучшие награды
- Опциональная "страховая викторина" дает бонусную энергию (+1) при прохождении

**Преимущества для вовлеченности:** Поощряет ежедневные посещения для использования всего запаса энергии до сброса, причем каждая полная сессия занимает 5-10 минут.

## 3. Ежедневное Колесо Фортуны + Мультипликатор серий

**Концепция:** Добавить ежедневное колесо наград, которое предлагает рандомизированные награды после завершения сценария, с улучшенными призами за последовательные дни.

**Реализация:**
- Разблокируется только после выполнения ежедневного сценария
- Содержит коллекционные предметы, очки и виртуальную валюту
- Колесо имеет "джекпот-сектора" с премиальными наградами
- Последовательные дни увеличивают вероятность попадания на премиальные сектора

**Интеграция страховых предложений:**
- Премиальные сектора содержат "Карты Страховых Знаний", которые кратко объясняют преимущества конкретных полисов
- Сбор наборов этих карт разблокирует эксклюзивные награды
- Функция "Страховой Консультант" предлагает, какие карты собирать на основе профиля пользователя

**Преимущества для вовлеченности:** Создает мощное ежедневное ожидание награды (проверенный психологический крючок), естественно знакомя пользователей со страховой информацией.

## 4. Социальные вызовы и перезагрузка лидерборда

**Концепция:** Внедрить ежедневные испытания с элементами социального признания, которые обновляются каждые 24 часа.

**Реализация:**
- Ежедневное испытание связано с новым сценарием (например, "Самое креативное решение" или "Самый безопасный выбор")
- Облегченное общественное голосование за лучшие решения
- 24-часовые таблицы лидеров с небольшими наградами для лучших исполнителей
- "Сеть безопасности друзей", где вы защищаете свои связи правильными решениями

**Интеграция страховых предложений:**
- Темы испытаний связаны с категориями страхования (дом, авто, путешествия, здоровье)
- Секция комментариев показывает реальные примеры того, как страхование помогло в подобных ситуациях
- Достижения в таблице лидеров включают значки и звания, связанные со страхованием

**Преимущества для вовлеченности:** Социальное признание и конкуренция стимулируют ежедневные проверки, а участие в сценарии и голосование естественно увеличивают время сессии до 5-10 минут.

## Интеграция в существующую архитектуру

### Изменения Frontend

**Новые компоненты:**
- `<DailyChainProgress />` — визуализирует прогресс по ежедневной цепочке сценариев
- `<EnergyBar />` — отображает и управляет очками энергии пользователя
- `<FortuneWheelModal />` — интерактивное колесо фортуны с анимациями
- `<DailyLeaderboard />` — таблица лидеров с возможностью голосования

**Изменения в маршрутизации:**
- `/scenario` → реструктурирован для поддержки нескольких точек принятия решений в день
- Новый маршрут `/fortune-wheel` для ежедневного колеса
- Новый маршрут `/daily-challenge` для социальных вызовов

### Изменения Backend

**Новые API-эндпоинты:**
- `GET /api/scenario/chain` — возвращает текущую цепочку сценариев и статус её прохождения
- `GET /api/energy` — информация о текущей энергии пользователя
- `POST /api/fortune-wheel/spin` — крутит колесо фортуны и возвращает результат
- `GET /api/challenges/daily` — получает текущий ежедневный вызов
- `POST /api/challenges/vote` — отправляет голос за решение другого пользователя

**Расширенная схема данных:**
```json
{
  "user_id": "...",
  "avatar": { … },
  "history": [ { "date": "2025-05-23", "scenarioChain": ["morning_id", "afternoon_id", "evening_id"], "choices": [1, 2, 1], "outcomes": ["..."] } ],
  "energy": {
    "current": 3,
    "max": 5,
    "next_refill": "2025-05-24T00:00:00Z",
    "streak_bonus": 2
  },
  "streak": 3,
  "points": 120,
  "collections": {
    "items": ["item_01", "item_02"],
    "insurance_cards": ["auto_coverage", "home_safety"]
  },
  "achievements": [ "achievement_01" ],
  "wheel_spins": {
    "available": 1,
    "last_spin": "2025-05-22T14:30:00Z"
  },
  "social": {
    "votes_received": 12,
    "votes_available": 3,
    "connected_users": ["user_123", "user_456"]
  }
}
```

### Cron-задачи и планировщики

- **06:00** — Генерация утреннего сценария + push-уведомление
- **12:00** — Генерация дневного продолжения + push-уведомление
- **18:00** — Генерация вечернего заключения + push-уведомление
- **00:00** — Сброс энергии, таблиц лидеров, пересчёт бонусов за серию (streak)

### Мониторинг и метрики

Добавить мониторинг новых ключевых показателей:
- Среднее время между сессиями в цепочке сценариев
- Коэффициент завершения ежедневной цепочки
- Коэффициент использования колеса фортуны
- Активность голосования и социальных взаимодействий
- Время, проведенное на страницах со страховыми предложениям
